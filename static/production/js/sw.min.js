function serializeRequest(e){var t={url:e.url,headers:serializeHeaders(e.headers),method:e.method,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer};return"GET"!==e.method&&"HEAD"!==e.method?e.clone().text().then((function(e){return t.body=e,Promise.resolve(t)})):Promise.resolve(t)}function serializeResponse(e){var t={headers:serializeHeaders(e.headers),status:e.status,statusText:e.statusText};return e.clone().text().then((function(e){return t.body=e,Promise.resolve(t)}))}function serializeHeaders(e){var t={};for(var n of e.entries())t[n[0]]=n[1];return t}function deserializeResponse(e){return Promise.resolve(new Response(e.body,e))}function cachePut(e,t,n){var r;getPostId(e.clone()).then((function(n){return r=e.referrer,serializeResponse(t.clone())})).then((function(e){var t={key:r,response:e,timestamp:Date.now()};n.add(t).catch((function(e){n.update(t.key,t)}))}))}function cacheMatch(e,t){return getPostId(e.clone()).then((function(e){return t.get(e)})).then((function(e){return e?deserializeResponse(e.response):new Response("",{status:503,statusText:"Service Unavailable"})}))}function getPostId(e){return new Promise(((t,n)=>{t(JSON.stringify(serializeRequest(e.clone())))}))}function any(e,t){return e.includes(t)}self.importScripts("/frontendPWA/dexie.js");const syncEvents=[],db=new Dexie("post_cache");db.version(1).stores({post_cache:"key,response,timestamp"}),self.addEventListener("push",(function(e){var t={body:e.data?e.data.text():"Push message no payload",icon:"/images/newLogos/SwiftmoBadgeWHITEBACKGROUNDCIRCLE.png",vibrate:[100,50,100],data:{dateOfArrival:Date.now(),primaryKey:1},actions:[{action:"explore",title:"Explore this new world",icon:"images/checkmark.png"},{action:"close",title:"I don't want any of this",icon:"images/xmark.png"}]};e.waitUntil(self.registration.showNotification("Push Notification",t))})),self.addEventListener("install",(e=>{e.waitUntil(caches.open("v1").then((e=>e.addAll(["/frontendPWA/manifest.json","/frontendPWA/dexie.js","/","/shop","/about","/blog"]))))})),self.addEventListener("fetch",(e=>{if("GET"===e.request.method&&!e.request.url.includes("/backend")&&!e.request.url.includes("/video")){e.respondWith((async()=>{let t=await caches.open("v1"),n=await t.match(e.request);if(n)return function(e){(async()=>{try{let t=await caches.open("v1"),n=await fetch(e.request);if(n){await t.put(e.request.url,n.clone())}else console.warn("Network fetch failed, device is possibly offline")}catch(e){return void console.warn("Offline")}})()}(e),n;{let n=await fetch(e.request);await t.put(e.request.url,n.clone());return n}})())}"GET"!==e.request.method||e.request.url.includes("/backend")||e.request.url.includes("/video")||e.respondWith(fetch(e.request.clone()).then((function(t){return cachePut(e.request.clone(),t.clone(),db.post_cache),t})).catch((function(){return cacheMatch(e.request.clone(),db.post_cache)})))}));